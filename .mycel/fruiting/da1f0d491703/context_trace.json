{
  "session_id": "da1f0d491703",
  "task_id": "cf4599fd-9b10-457e-8b0a-8c17b2c32b38",
  "agent": "claude",
  "model": "sonnet",
  "repo_path": "/home/mkagent/repos/terror-in-the-jungle",
  "timestamp": "2026-01-24T18:36:38.629212",
  "layers": [
    {
      "name": "prompt",
      "content": "# Task: Add Visual Hit Markers for Combat Feedback\n\nYou are working on terror-in-the-jungle, a 3D pixel art battlefield game built with Three.js. The combat needs better feedback - specifically hit markers when the player lands shots.\n\n## Context\nThe game has recently added floating damage numbers (see recent commits), but still lacks the satisfying hit markers that confirm shots landed. The priority is improving \"Combat Feel & Feedback\" per CLAUDE.md.\n\n## Discovery - Read These Files First\n1. CLAUDE.md - Project guidelines (especially \"Combat Feel & Feedback\" section)\n2. src/ui/hud/HUDSystem.ts - Main HUD orchestrator\n3. src/ui/hud/HUDElements.ts - HUD components\n4. src/ui/hud/DamageNumberSystem.ts - Recently added damage numbers (reference for hit effects)\n5. src/systems/player/FirstPersonWeapon.ts - Where shots are fired\n6. src/systems/combat/CombatantCombat.ts - Where hits are registered\n\n## Implementation Requirements\n\n### 1. Create HitMarker UI Component\nCreate src/ui/hud/HitMarkerSystem.ts:\n- Display a crosshair-style hit marker in screen center when player hits an enemy\n- Different visuals for normal hit vs headshot vs kill\n- Fade out animation (0.3s duration)\n- Simple \"X\" or cross pattern design using HTML/CSS\n- Support for multiple rapid hits (queue system)\n\n### 2. Visual Design\n- Normal hit: White X, thin lines\n- Headshot: Red X, slightly larger\n- Kill: Red X with brief expansion animation\n- All markers should be centered on screen crosshair position\n\n### 3. Integration Points\nIntegrate with FirstPersonWeapon.ts fire() method or CombatantCombat's hit detection to trigger markers:\n- When handlePlayerShot returns hit=true, show marker\n- Pass headshot/killed flags for appropriate visual\n\n### 4. HUD System Integration\nAdd HitMarkerSystem to HUDSystem.ts:\n- Initialize in constructor\n- Add showHitMarker(type: 'hit' | 'headshot' | 'kill') method\n- Clean up in dispose()\n\n## Design Constraints\n- Keep it simple - no complex animations\n- Use DOM elements (like existing HUD), not WebGL overlays\n- Maximum 5 markers visible at once (pool system)\n- Follow existing code style (no semicolons, TypeScript strict)\n\n## Validation\n1. Run `npm run dev`\n2. Shoot enemies and verify hit markers appear\n3. Confirm different visuals for headshots and kills\n4. Check no console errors\n5. Run `npm run build`\n\n## Completion\nWhen done:\n1. Test thoroughly - markers should feel responsive and satisfying\n2. Commit with message: \"feat(ui): add hit markers for combat feedback\"\n3. Provide summary with screenshots if possible",
      "source": "task.prompt"
    },
    {
      "name": "output_format",
      "content": "Required output format: <task_result> block with commit, pr_url, branch, summary",
      "source": "generated"
    }
  ]
}